package main

import (
	"fmt"
	"github.com/ChengHoward/CycleTLS/cycletls"
	"github.com/ChengHoward/CycleTLS/cycletls/imitate"
	"io"
)

func main() {
	fileURL := "https://www.sciencedirect.com/sdfe/pdf/download"
	client := cycletls.Init()

	requestBody := "token=W0QrerDnGbsx%2ByB%2FZu8G%2Fgd14Q3L%2FdsGrmQFrrO%2F8v9DltAr5hD2kWtjwPUzfLjDeMv0Mt%2FjM9seZNiamAqZfjn67MOTzbrpOyrAH93LKhO71EFwMqHHEI4k7VAz49Sc%2BP5dV8VHZbfLHqCHVWAdJdoTDKv861FFJQeMvUXqx5Fm7HKjU553q4vJ0ObvDl6otrAOq0UIf4kNqMDZ7o5z3lmz8SH5Ut4iBWK2aU6ZBSqv8df0nwA6xc50ZSqiVON5vmh6LpOJZiEba35K7mRnvbBwAJZwbEGyuGVQGuZKuC8jQSJ9IwLAoRKfP3vNyZZOhB8JAyZjZR52NYb2GNH59X%2FtGl6PZOFpMwgUdJC0j9kEX%2BYpYzwMKkjJVGQfq79OrudJ3OZFy7eqZ2lR92blQwXkOF6OgZC8FIMBopB%2Bze5fW0BTVpACqrL9N%2FJLMs1OtOOUbNz6kiS%2Bs35L9b1qrn8TWYz09WYAHDIYpzsKYh9nKH8TDF3KNI1S4HbhZ7gz7rWC5OM6NG%2B9rutyZYVtX%2FMFwNMOkAOK7q0qC1yCt6rMyHqVyq8b%2FmUL%2Bl4aqjuRdH7cv5mhOVMa4uEg4eTz&pii=%5B%27pii%3AS2090123221001491%27%2C+%27pii%3AS2090123221001260%27%2C+%27pii%3AS2090123221001338%27%2C+%27pii%3AS2090123221001363%27%2C+%27pii%3AS2090123221002289%27%2C+%27pii%3AS2090123221001533%27%2C+%27pii%3AS2090123221001466%27%2C+%27pii%3AS2090123221001508%27%2C+%27pii%3AS2090123221001302%27%2C+%27pii%3AS2090123221001375%27%2C+%27pii%3AS209012322100148X%27%2C+%27pii%3AS2090123222000431%27%2C+%27pii%3AS209012322100196X%27%2C+%27pii%3AS2090123221001387%27%2C+%27pii%3AS2090123221001454%27%2C+%27pii%3AS2090123221001429%27%2C+%27pii%3AS2090123221001405%27%2C+%27pii%3AS2090123221001909%27%2C+%27pii%3AS2090123221001545%27%2C+%27pii%3AS2090123221001016%27%2C+%27pii%3AS2090123221001557%27%5D"

	options := cycletls.Options{
		Body:    requestBody,
		Timeout: 120,
		Headers: map[string]string{
			"Referer":      "https://www.sciencedirect.com/science/article/pii/S2090123221001491",
			"Origin":       "https://www.sciencedirect.com",
			"Content-Type": "application/x-www-form-urlencoded",
			"Cookie":       "EUID=f873cd3b-132d-4b43-8222-406b2c500072; sd_session_id=693406304c16a5453e1835814c62198db5f8gxrqa; acw=693406304c16a5453e1835814c62198db5f8gxrqa%7C%24%7C4AC420ADD7FE1258A483342BCFFD5FBF73F02384BDD8E82AFD31BD52F64E5EFA5D58A1003A987AF68595A2B67F82C9D91800858440AFAE6C3FBA44D1BD4E4F2EB0469A67597464825D387A21AFA2E514; id_ab=AEG; AMCVS_4D6368F454EC41940A4C98A6%40AdobeOrg=1; __cf_bm=va6Vgfcl2GvaV4sMxDii3NAbBeRWltgt_Q41Y7fIsYU-1692949555-0-AUgk7h5lxySwigNUr/FqOEgmkJxOWI4khR//ce1HXbCrPhrfPhPbeaSYm87Vwwzq3VPF45sI1SpLnR3wlPnpOaNepTa02UOOFntzuh96qP5T; mboxes=%7B%22sd%3Aaccessbanner-purchase-pdf-link%22%3A%7B%22variation%22%3A%22B%22%7D%2C%22header-sign-in%22%3A%7B%22variation%22%3A%22%231%22%2C%22enabled%22%3Afalse%7D%7D; cf_clearance=fYi8N9MjogLeihfq.LjH62dAM.D9B.Dug5f4pH16C1I-1692949572-0-1-b345c0de.4edf78f5.e4449f3e-0.2.1692949572; cra-ch-clearance=7fc239f61cb6107f:62323839316164323433666663333832393030376566393239393038646238363663333364356138363135323766633164643666373333356632393631313538373666366430323066323432333234613964306562303a613563336462376135633564336237303331626439396231; MIAMISESSION=e5d30b57-40d4-4e07-acc6-aef403841f20:3870402447; mbox=session%23aa05a8eaaae34f54973454ed2f7cd3da%231692951508%7CPC%23aa05a8eaaae34f54973454ed2f7cd3da.34_0%231756194448; AMCV_4D6368F454EC41940A4C98A6%40AdobeOrg=179643557%7CMCIDTS%7C19595%7CMCMID%7C92210762329710933277125674301258661997%7CMCAID%7CNONE%7CMCOPTOUT-1692956851s%7CNONE%7CvVersion%7C5.5.0; SD_ART_LINK_STATE=%3Ce%3E%3Cq%3Escience%3C%2Fq%3E%3Corg%3EsdlPdf%3C%2Forg%3E%3Cz%3EDDM%3C%2Fz%3E%3Crdt%3E2023%2F08%2F25%2F07%3A47%3A31%3A908%3C%2Frdt%3E%3Cenc%3EN%3C%2Fenc%3E%3C%2Fe%3E; s_pers=%20c19%3Dsd%253Aproduct%253Ajournal%253Aarticle%7C1692951451372%3B%20v68%3D1692949647732%7C1692951451380%3B%20v8%3D1692949651929%7C1787557651929%3B%20v8_s%3DLess%2520than%25201%2520day%7C1692951451929%3B; s_sess=%20s_cpc%3D0%3B%20s_ppvl%3Dsd%25253Aproduct%25253Ajournal%25253Aarticle%252C24%252C24%252C1031%252C1332%252C931%252C1920%252C1080%252C1%252CP%3B%20e41%3D1%3B%20s_cc%3Dtrue%3B%20s_ppv%3Dsd%25253Aproduct%25253Ajournal%25253Aarticle%252C2%252C2%252C1031%252C1332%252C931%252C1920%252C1080%252C1%252CP%3B%20s_sq%3Delsevier-global-prod%253D%252526pid%25253Dsd%2525253Aproduct%2525253Ajournal%2525253Aarticle%252526pidt%25253D1%252526oid%25253DfunctionHc%25252528%25252529%2525257B%2525257D%252526oidt%25253D2%252526ot%25253DSUBMIT%3B",
		},
	}
	imitate.Chrome(&options)
	resp, err := client.Do(fileURL, &options, "POST")
	defer func(Body io.ReadCloser) {
		err := Body.Close()
		if err != nil {

		}
	}(resp.Body)

	if err != nil {
		fmt.Println("Error:", err)
		return
	}
	//body, err := io.ReadAll(resp.Body)
	//if err != nil {
	//	fmt.Println("Error:", err)
	//	return
	//}
	fmt.Println(resp.Status)
	fmt.Println(string(body))
}
